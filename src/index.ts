import 'dotenv/config'
import { informationGathering, scanEnum } from './scripts'
import { readFile, verifyData } from './utils'

async function main(): Promise<void> {
  const domain = process.argv[2]

  const subdomainDataEnumFile = 'subdomain.data.json'
  const informationGatheringResult = verifyData(domain, subdomainDataEnumFile)
    ? readFile(domain, subdomainDataEnumFile)
    : await informationGathering(domain)

  const serviceEnumFile = 'service.json'
  const scanEnumResult = verifyData(domain, [serviceEnumFile, 'port.json'])
    ? readFile(domain, serviceEnumFile)
    : await scanEnum(domain, Object.keys(informationGatheringResult))
}

main()

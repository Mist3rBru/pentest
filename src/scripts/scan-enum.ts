import { portEnum, serviceEnum } from '../service/tools'
import { writeFile } from '../utils'

export async function scanEnum(
  domain: string,
  subdomainList: string[]
): Promise<string[]> {
  const [serviceList, portList] = await Promise.all([
    serviceEnum(subdomainList),
    portEnum(subdomainList)
  ])
  writeFile(domain, 'service.json', JSON.stringify(serviceList))
  writeFile(domain, 'port.json', JSON.stringify(portList))

  return serviceList
}

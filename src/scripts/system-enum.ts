import { writeFile } from '../utils'
import axios from 'axios'

export async function systemEnum(
  domain: string,
  subdomainList: string[]
): Promise<string[]> {
  const result: string[] = []

  for (const subdomain of subdomainList) {
    try {
      const url = `http://${subdomain}`
      const { status } = await axios.get(url, {
        timeout: 3000
      })
      if (status >= 200 && status < 400) {
        process.stdout.write(`system: ${url}\n`)
        result.push(url)
      }
    } catch (err) {}
  }

  writeFile(`system.${domain}.json`, JSON.stringify(result))

  return result
}
